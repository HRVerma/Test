package com.xavient.poker.controller;

import org.apache.commons.lang3.StringUtils;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.MediaType;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.bind.annotation.RequestBody;

import com.xavient.poker.dto.GamePlayerDTO;
import com.xavient.poker.model.Player;
import com.xavient.poker.service.GameService;

@Controller
@CrossOrigin()
public class PlayerLoginController {

	private static final String VIEW_LOGIN = "login";
	private static final String VIEW_JOIN_GAME = "join_game";
	
	@Autowired
	private GameService gameService;

	@RequestMapping("/")
	public String home() throws Exception {
		return VIEW_LOGIN;

	}

	@RequestMapping(value = "/playerLogin",method = RequestMethod.POST, consumes = { MediaType.APPLICATION_JSON_VALUE,
			MediaType.APPLICATION_XML_VALUE }, produces = MediaType.APPLICATION_JSON_VALUE)
	@ResponseBody
	public Player playerLogin(@RequestBody Player player) {
		System.out.println("Welcome PlayerLoginController playerLogin POST");
		if (StringUtils.isNotBlank(player.getName()) && StringUtils.isNotBlank(player.getEmail())){			
			GamePlayerDTO gamePlayerDTO = gameService.savePlayerCredential(player.getGuid(), player.getName(), player.getEmail());
//			if(null !=gamePlayerDTO){
//				modelAndView.addObject("gamePlayerDTO", gamePlayerDTO);
//				modelAndView.addObject("GUID", guid);
//				modelAndView.setViewName("join-game");
//				return modelAndView;
//			}
		}
		return player;
	}

}
